<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Friends - Community Hub</title>
    <link rel="stylesheet" href="../styles/homestyles.css">
    <link rel="stylesheet" href="../styles/friends.css">
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">Community Hub</div>
            <div class="time-display">
                <div id="current-time">10:30 AM</div>
                <div class="date" id="current-date">Thursday, July 10, 2025</div>
            </div>
            <div class="user-section">
                <span id="welcome-user">Welcome, User!</span>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </div>
    </header>

    <nav class="nav">
        <button class="mobile-nav-toggle" id="mobile-nav-toggle">
            Navigation Menu
        </button>
        <div class="nav-content">
            <a href="home.html" class="nav-item">Home</a>
            <a href="#" class="nav-item">Nearby Events</a>
            <a href="map.html" class="nav-item">Map</a>
            <a href="Calendar.html" class="nav-item">Calendar</a>
            <a href="#" class="nav-item">Notifications</a>
            <a href="profile.html" class="nav-item">Profile</a>
            <a href="friends.html" class="nav-item active">Friends</a>
            <a href="#" class="nav-item">Settings</a>
        </div>
        <div class="nav-dropdown" id="nav-dropdown">
            <a href="home.html" class="nav-item">Home</a>
            <a href="#" class="nav-item">Nearby Events</a>
            <a href="map.html" class="nav-item">Map</a>
            <a href="Calendar.html" class="nav-item">Calendar</a>
            <a href="#" class="nav-item">Notifications</a>
            <a href="profile.html" class="nav-item">Profile</a>
            <a href="friends.html" class="nav-item active">Friends</a>
            <a href="#" class="nav-item">Settings</a>
        </div>
    </nav>

    <main class="main-content">
        <div class="friends-container">
            <!-- Header Section -->
            <div class="friends-header">
                <h1>üßë‚Äçü§ù‚Äçüßë Friends</h1>
                <div class="friends-stats">
                    <span class="stat-item">
                        <strong id="friend-count">0</strong> Friends
                    </span>
                    <span class="stat-item">
                        <strong id="pending-count">0</strong> Pending
                    </span>
                </div>
            </div>

            <!-- Status Message -->
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 8px; margin: 10px 0; text-align: center;">
                <h3>‚úÖ Friends Page is Working!</h3>
                <p>User is logged in and page is functioning correctly. Add some friends to see them here!</p>
            </div>

            <!-- Search and Add Friends Section -->
            <div class="search-section">
                <div class="search-container">
                    <input type="text" id="search-input" placeholder="Search for friends by username or email..." class="search-input">
                    <button onclick="searchUsers()" class="search-btn">Search</button>
                </div>
                <div id="search-results" class="search-results"></div>
            </div>

            <!-- Tab Navigation -->
            <div class="tab-nav">
                <button class="tab-btn active" onclick="showTab('friends')" data-tab="friends">
                    My Friends
                </button>
                <button class="tab-btn" onclick="showTab('pending')" data-tab="pending">
                    Friend Requests
                    <span class="badge" id="pending-badge" style="display: none;">0</span>
                </button>
                <button class="tab-btn" onclick="showTab('sent')" data-tab="sent">
                    Sent Requests
                </button>
            </div>

            <!-- Tab Content -->
            <div class="tab-content">
                <!-- Friends List Tab -->
                <div id="friends-tab" class="tab-pane active">
                    <div class="friends-list" id="friends-list">
                        <div class="loading" id="friends-loading">Loading friends...</div>
                        <div class="empty-state" id="friends-empty" style="display: none;">
                            <h3>No friends yet</h3>
                            <p>Start by searching for people to add as friends!</p>
                        </div>
                    </div>
                </div>

                <!-- Pending Requests Tab -->
                <div id="pending-tab" class="tab-pane">
                    <div class="requests-list" id="pending-requests">
                        <div class="loading" id="pending-loading">Loading requests...</div>
                        <div class="empty-state" id="pending-empty" style="display: none;">
                            <h3>No pending requests</h3>
                            <p>When someone sends you a friend request, it will appear here.</p>
                        </div>
                    </div>
                </div>

                <!-- Sent Requests Tab -->
                <div id="sent-tab" class="tab-pane">
                    <div class="requests-list" id="sent-requests">
                        <div class="loading" id="sent-loading">Loading sent requests...</div>
                        <div class="empty-state" id="sent-empty" style="display: none;">
                            <h3>No sent requests</h3>
                            <p>Friend requests you send will appear here.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal for user confirmation -->
    <div id="confirmation-modal" class="modal">
        <div class="modal-content">
            <h3 id="modal-title">Confirm Action</h3>
            <p id="modal-message">Are you sure you want to perform this action?</p>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                <button class="btn btn-primary" id="confirm-btn" onclick="confirmAction()">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Success/Error Messages -->
    <div id="message-container" class="message-container"></div>

    <script>
        console.log('Friends.html script loaded');
        console.log('Document ready state:', document.readyState);
        console.log('Current localStorage:');
        console.log('- user_id:', localStorage.getItem('user_id'));
        console.log('- username:', localStorage.getItem('username'));
        console.log('- email:', localStorage.getItem('email'));
    </script>
    <script src="../backend/friends.js"></script>
</body>
</html>
